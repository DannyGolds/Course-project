#include "pch.h"
#include "Globals.h"
#include "Structures.h"
#include <map>
#include <vector>
#include <string>

std::vector<LogEntry> logs;
std::vector<LogEntry> copied_logs;
AppState state;
AppState recentState;
CString logPath;
int cpl_l = 0;
int cpl_m = 0;
int cpl_h = 0;
CString savePath = L"";
CString takePath = L"";
std::map<std::wstring, std::wstring> processes;
std::map<std::wstring, std::wstring> commandRisk = {
    {L"execve", L"Высокая - запуск произвольных программ"},
    {L"ptrace", L"Высокая - слежение за процессами"},
    {L"access", L"Низкая - проверка доступности файлов"},
    {L"mmap", L"Высокая - возможное внедрение кода"},
    {L"connect", L"Средняя - создание сетевого подключения"},
    {L"unlink", L"Высокая - удаление файлов"},
    {L"write", L"Средняя - запись в файл"},
    {L"close", L"Низкая - закрытие файла"},
    {L"openat", L"Средняя - открытие файла отн. каталога"},
    {L"newfwstat", L"Низкая - выявление статистики по файлу"},
    {L"read", L"Средняя - чтение данных (возможно, конфиденциальных)"},
    {L"rename", L"Средняя - переименование файла"},
    {L"chmod", L"Высокая - изменение прав на файл"},
    {L"chown", L"Высокая - смена владельца файла"},
    {L"fchmod", L"Высокая - изменение прав на файл"},
    {L"arch_prctl", L"Средняя - управление архитектурными параметрами"},
    {L"socket", L"Средняя - создание сокета"},
    {L"getpid", L"Низкая - получение идентификатора процесса"},
    {L"fork", L"Средняя - создание нового процесса"},
    {L"execveat", L"Высокая - запуск произвольных программ"},
    {L"kill", L"Средняя - завершение процессов"},
    {L"sendto", L"Средняя - отправка данных в сеть"},
    {L"brk", L"Низкая - выделение дополнительной памяти"},
    {L"mprotect", L"Высокая - изменение прав доступа к памяти"},
    {L"fstat", L"Низкая - получение статистической информации о файле"},
    {L"stat", L"Низкая - получение статистической информации о файле"},
    {L"getuid", L"Низкая - получение UID"},
    {L"getgid", L"Низкая - получение GID"},
    {L"geteuid", L"Низкая - получение EUID"},
    {L"getegid", L"Низкая - получение EGID"},
    {L"getresuid", L"Низкая - получение UID, EUID, SUID"},
    {L"getresgid", L"Низкая - получение GID, EGID, SGID"},
    {L"setresuid", L"Высокая - изменение UID, EUID, SUID"},
    {L"setresgid", L"Высокая - изменение GID, EGID, SGID"},
    {L"setuid", L"Высокая - изменение UID"},
    {L"setgid", L"Высокая - изменение GID"},
    {L"setreuid", L"Высокая - изменение UID"},
    {L"setregid", L"Высокая - изменение GID"},
    {L"clone", L"Высокая - создание нового процесса или потока"},
    {L"bind", L"Средняя - привязка сокета к адресу"},
    {L"listen", L"Средняя - ожидание входящих подключений"},
    {L"accept", L"Средняя - принятие входящего подключения"},
    {L"recvfrom", L"Средняя - получение данных из сети"},
    {L"shutdown", L"Средняя - завершение работы сокета"},
    {L"dup", L"Низкая - дублирование файлового дескриптора"},
    {L"dup2", L"Низкая - дублирование файлового дескриптора"},
    {L"dup3", L"Низкая - дублирование файлового дескриптора"},
    {L"pipe", L"Средняя - создание канала для межпроцессного взаимодействия"},
    {L"pipe2", L"Средняя - создание канала для межпроцессного взаимодействия"},
    {L"poll", L"Низкая - ожидание событий на файловых дескрипторах"},
    {L"select", L"Низкая - ожидание событий на файловых дескрипторах"},
    {L"epoll_create", L"Низкая - создание epoll-дескриптора"},
    {L"epoll_ctl", L"Низкая - управление epoll-дескриптором"},
    {L"epoll_wait", L"Низкая - ожидание событий epoll"},
    {L"readlink", L"Низкая - чтение символической ссылки"},
    {L"symlink", L"Средняя - создание символической ссылки"},
    {L"mount", L"Высокая - монтирование файловой системы"},
    {L"umount", L"Высокая - размонтирование файловой системы"},
    {L"reboot", L"Высокая - перезагрузка системы"},
    {L"sethostname", L"Высокая - изменение имени хоста"},
    {L"gethostname", L"Низкая - получение имени хоста"},
    {L"gettimeofday", L"Низкая - получение текущего времени"},
    {L"settimeofday", L"Высокая - изменение системного времени"},
    {L"sysinfo", L"Низкая - получение информации о системе"},
    {L"uname", L"Низкая - получение информации о системе"},
    {L"prctl", L"Средняя - управление процессом"},
    {L"capset", L"Высокая - изменение возможностей процесса"},
    {L"capget", L"Низкая - получение возможностей процесса"},
    {L"wait4", L"Низкая - ожидание завершения процесса"},
    {L"waitpid", L"Низкая - ожидание завершения процесса"},
    {L"exit", L"Низкая - завершение процесса"},
    {L"exit_group", L"Низкая - завершение группы процессов"}
};
